<div class="message-list-container">
  <!-- SVG Gradient Definition -->
  <svg width="0" height="0" style="position: absolute;">
    <defs>
      <linearGradient id="gemini-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#4285f4"/>
        <stop offset="33%" style="stop-color:#9b72cb"/>
        <stop offset="66%" style="stop-color:#d96570"/>
        <stop offset="100%" style="stop-color:#d96570"/>
      </linearGradient>
    </defs>
  </svg>

  @if (messages().length === 0 && !isLoading() && !streamingContent()) {
    <!-- Empty State - Gemini style -->
    <div class="empty-state">
      <div class="greeting-icon">
        <svg viewBox="0 0 28 28" fill="none">
          <path d="M14 0L17.5 10.5L28 14L17.5 17.5L14 28L10.5 17.5L0 14L10.5 10.5L14 0Z" fill="url(#gemini-gradient)"/>
        </svg>
      </div>
      <h3>Bonjour, comment puis-je vous aider ?</h3>
      <p>Posez une question sur les ressources humaines, je suis l√† pour vous accompagner</p>
    </div>
  } @else {
    <!-- Message List with Scroll -->
    <div class="messages-scroll" #scrollContainer>
      @for (message of messages(); track trackByMessageId($index, message)) {
        <div class="message-group">
          <!-- User Question -->
          <div class="message message-user">
            <div class="message-content">
              <p>{{ message.question.text }}</p>
            </div>
          </div>

          <!-- Assistant Answer -->
          <div class="message message-assistant">
            <div class="assistant-icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 0L14.7 9.3L24 12L14.7 14.7L12 24L9.3 14.7L0 12L9.3 9.3L12 0Z" fill="url(#gemini-gradient)"/>
              </svg>
            </div>
            <div class="message-wrapper">
              <div class="message-content markdown-content">
                <markdown [data]="message.answer.content"></markdown>
              </div>
              <!-- Source Documents -->
              <app-source-list [sources]="message.answer.sources"></app-source-list>
            </div>
          </div>
        </div>
      }

      <!-- Streaming Message -->
      @if (streamingContent()) {
        <div class="message message-assistant message-streaming">
          <div class="assistant-icon">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M12 0L14.7 9.3L24 12L14.7 14.7L12 24L9.3 14.7L0 12L9.3 9.3L12 0Z" fill="url(#gemini-gradient)"/>
            </svg>
          </div>
          <div class="message-wrapper">
            <div class="message-content markdown-content">
              <markdown [data]="streamingContent()"></markdown><span class="streaming-cursor"></span>
            </div>
          </div>
        </div>
      }

      <!-- Loading Indicator -->
      @if (isLoading() && !streamingContent()) {
        <div class="message message-assistant message-loading">
          <div class="assistant-icon">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M12 0L14.7 9.3L24 12L14.7 14.7L12 24L9.3 14.7L0 12L9.3 9.3L12 0Z" fill="url(#gemini-gradient)"/>
            </svg>
          </div>
          <div class="message-wrapper">
            <div class="message-content">
              <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
